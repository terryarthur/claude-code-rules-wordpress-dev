# WordPress Development Rules for Claude Code

## Git & Project Management

### Repository Management
- Always gitignore all `.md` files except the project's `readme.md`
- Always gitignore the `.claude` folder and any files or folders not specifically required for the project to function
- Never add co-author, "generated by", or links to OpenAI in commits or anywhere in the codebase
- Always open a new branch for each feature and push as each feature is completed
- Do not use emoji icons in commits, code, or documentation unless specifically requested with explicit permission - they make work appear AI-generated

### Package Management
- Create a `package` folder and keep it synced to project files
- This folder should contain only files and folders explicitly required for the project to function
- Use this folder to create clean archives for testing and distribution
- Exclude development files, documentation, and build tools from the package folder

## WordPress Security Standards

### Input Sanitization & Validation
- **ALWAYS** sanitize ALL user inputs using WordPress functions:
  - `sanitize_text_field()` for single-line text
  - `sanitize_textarea_field()` for multi-line text
  - `sanitize_email()` for email addresses
  - `sanitize_url()` for URLs
  - `absint()` for positive integers
  - `sanitize_key()` for array keys and option names

### Output Escaping
- **ALWAYS** escape ALL output using appropriate WordPress functions:
  - `esc_html()` for HTML content
  - `esc_attr()` for HTML attributes
  - `esc_url()` for URLs
  - `esc_js()` for JavaScript
  - `esc_sql()` for SQL queries (though prepared statements are preferred)
  - `wp_kses()` or `wp_kses_post()` for allowing specific HTML tags

### Nonces & CSRF Protection
- **REQUIRED**: Implement nonces for ALL forms, AJAX requests, and sensitive actions
- Create nonces: `wp_nonce_field('action_name', 'nonce_field_name')`
- Verify nonces: `wp_verify_nonce($_POST['nonce_field_name'], 'action_name')`
- Use appropriate nonce functions:
  - `wp_nonce_url()` for URLs
  - `wp_nonce_field()` for forms
  - `wp_create_nonce()` for AJAX
  - `check_ajax_referer()` for AJAX requests

### Database Security
- **ALWAYS** use WordPress prepared statements for database queries
- Use `$wpdb->prepare()` for all custom queries
- Never concatenate user input directly into SQL queries
- Validate and sanitize data before database operations
- Use WordPress query functions when possible (`WP_Query`, `get_posts()`, etc.)

### Capability Checks
- **ALWAYS** verify user permissions before executing sensitive operations
- Use `current_user_can()` to check capabilities
- Common capabilities: `manage_options`, `edit_posts`, `upload_files`, `edit_theme_options`
- Check capabilities early in functions and fail securely

### File Security
- Validate file uploads with `wp_check_filetype_and_ext()`
- Restrict file types and sizes appropriately
- Never allow PHP file uploads from users
- Use WordPress filesystem API for file operations
- Implement proper file path validation to prevent directory traversal

## Code Quality & Standards

### WordPress Coding Standards (WPCS)
- **MANDATORY**: All code must pass PHPCS with WordPress coding standards
- Run `phpcs --standard=WordPress` on all PHP files before committing
- Fix ALL errors and warnings - no exceptions
- Use WordPress naming conventions:
  - Functions: `prefix_function_name()`
  - Classes: `Prefix_Class_Name`
  - Constants: `PREFIX_CONSTANT_NAME`
  - Hooks: `prefix_hook_name`

### Error Handling
- No PHP errors, warnings, or notices will be tolerated
- Every single error must be fixed before committing
- Use proper error handling with `WP_Error` class
- Log errors appropriately using `error_log()` or WordPress debug logging
- Never suppress errors with `@` operator without proper handling

### Performance Standards
- Minimize database queries - use query optimization
- Implement proper caching where appropriate
- Avoid loading unnecessary scripts and styles
- Use WordPress transients for expensive operations
- Optimize images and assets
- Follow WordPress performance best practices

## File Structure & Organization

### Plugin Structure
```
plugin-name/
├── plugin-name.php (main file)
├── uninstall.php
├── includes/
│   ├── class-plugin-name.php
│   ├── class-admin.php
│   └── functions.php
├── admin/
│   ├── css/
│   ├── js/
│   └── partials/
├── public/
│   ├── css/
│   ├── js/
│   └── partials/
└── languages/
```

### Theme Structure
```
theme-name/
├── style.css
├── index.php
├── functions.php
├── inc/
│   ├── theme-setup.php
│   ├── customizer.php
│   └── template-functions.php
├── template-parts/
├── assets/
│   ├── css/
│   ├── js/
│   └── images/
└── languages/
```

### File Naming
- Use lowercase with hyphens for file names: `my-custom-file.php`
- Prefix all functions, classes, and constants with plugin/theme prefix
- Use descriptive, meaningful file and function names

## Development Workflow

### Code Review Process
- Check your work with PHPCS and WPCS after editing each file
- Test all functionality in multiple environments
- Verify security measures are properly implemented
- Ensure accessibility standards are met
- Test with different user roles and capabilities

### Documentation
- Document all hooks (actions and filters) created
- Include inline comments for complex logic
- Maintain updated README.md with installation and usage instructions
- Document any custom database tables or options

### Testing Requirements
- Test on multiple WordPress versions (minimum supported version)
- Test with different themes (if applicable)
- Test with common plugins for compatibility
- Verify functionality with different user roles
- Test on different PHP versions

## User Experience Guidelines

### WordPress Integration
- Follow WordPress UI/UX patterns and conventions
- Use WordPress admin styles and components
- Implement proper WordPress admin notices
- Ensure mobile responsiveness
- Follow accessibility guidelines (WCAG 2.1 AA minimum)

### Performance Considerations
- Enqueue scripts and styles properly using WordPress hooks
- Only load assets when needed (conditional loading)
- Implement lazy loading for heavy operations
- Use WordPress caching mechanisms
- Minimize HTTP requests

### Internationalization
- Make all user-facing strings translatable
- Use WordPress i18n functions: `__()`, `_e()`, `_n()`, `esc_html__()`
- Create and maintain `.pot` files for translations
- Use proper text domains throughout

## WordPress Hooks & Actions

### Proper Hook Usage
- Use appropriate WordPress hooks for functionality
- Never modify core WordPress files
- Use filters to modify data, actions to trigger functionality
- Document any custom hooks created
- Follow WordPress hook naming conventions

### Common Required Hooks
- `init` - for initialization
- `wp_enqueue_scripts` - for frontend assets
- `admin_enqueue_scripts` - for admin assets
- `wp_ajax_` and `wp_ajax_nopriv_` - for AJAX handlers
- `admin_menu` - for admin pages

## Quality Assurance Checklist

Before committing any code, verify:
- [ ] All security measures implemented (nonces, escaping, sanitization)
- [ ] PHPCS/WPCS validation passed with zero errors/warnings
- [ ] All user inputs sanitized and outputs escaped
- [ ] Proper capability checks in place
- [ ] No PHP errors, warnings, or notices
- [ ] Performance optimized
- [ ] Accessibility guidelines followed
- [ ] Mobile responsive
- [ ] Cross-browser compatible
- [ ] Internationalization implemented
- [ ] Documentation updated

## Zero Technical Debt Policy

- We do not accumulate technical debt
- Fix issues immediately when discovered
- Refactor code that doesn't meet standards
- Update deprecated functions immediately
- Address all security vulnerabilities promptly
- Maintain consistent code quality throughout the project

---

**Remember**: We are creating professional-quality software. Every rule in this document is mandatory and non-negotiable. Quality, security, and WordPress best practices are our top priorities.